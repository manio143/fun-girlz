<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Wolna monada IO
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="Wprowadzenie do programowania funkcyjnego GirlzCamp 2018"/>
    <meta name="author" content="Marian Dziubiak"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link type="text/css" rel="stylesheet" href="/fun-girlz/content/style.css" />
    <script type="text/javascript" src="/fun-girlz/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="https://github.com/manio143/fun-girlz">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/fun-girlz/index.html">fun-girlz</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1><a name="Wolna-monada-IO" class="anchor" href="#Wolna-monada-IO">Wolna monada IO</a></h1>
<p>Co to znaczy, że monada jest wolna? Możemy podzielić monady na dwa typy: takie które wykonują się od razu (np. monada <code>Result</code>) oraz takie, które trzeba wykonać specjalną funkcją po zbudowaniu (np. monada <code>State</code>).</p>
<p>Wolne monady to drugie. Dokładniej rzecz biorąc jest to dużo bardziej skomplikowane, sam ledwo rozumiem zasady działania kategorii wolnych monad. Cel jest taki, że dopóki nie uruchomimy monady, to możemy ją bezkarnie budować i ani kawałek jej kodu nie zostanie wykonany.</p>
<p>Wolne monady mają więc zalety. Między innymi będzie to możliwość powtórzenia wykonania. Np. monadę stanu budujemy raz, a potem możemy wywoływać wiele razy z różnym stanem.</p>
<p>Teraz zbudujemy sobie wolną monadę <code>IO</code>, która w funkcyjny sposób pozwoli nam komunikowac się ze światem.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="t">IO</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">a</span><span class="o">&gt;</span> <span class="o">=</span>
    | <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="p">Pure</span> <span class="k">of</span> <span class="o">&#39;</span><span class="i">a</span>
    | <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="p">PutStrLn</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="t">string</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="t">unit</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs1', 6)" onmouseover="showTip(event, 'fs1', 6)" class="t">IO</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">a</span><span class="o">&gt;</span>)
    | <span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="p">GetStrLn</span> <span class="k">of</span> (<span onmouseout="hideTip(event, 'fs4', 8)" onmouseover="showTip(event, 'fs4', 8)" class="t">string</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs1', 9)" onmouseover="showTip(event, 'fs1', 9)" class="t">IO</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">a</span><span class="o">&gt;</span>)
    | <span onmouseout="hideTip(event, 'fs7', 10)" onmouseover="showTip(event, 'fs7', 10)" class="p">ReadFile</span> <span class="k">of</span> <span class="i">name</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs4', 11)" onmouseover="showTip(event, 'fs4', 11)" class="t">string</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs4', 12)" onmouseover="showTip(event, 'fs4', 12)" class="t">string</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs1', 13)" onmouseover="showTip(event, 'fs1', 13)" class="t">IO</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">a</span><span class="o">&gt;</span>)
    | <span onmouseout="hideTip(event, 'fs8', 14)" onmouseover="showTip(event, 'fs8', 14)" class="p">WriteFile</span> <span class="k">of</span> <span class="i">name</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs4', 15)" onmouseover="showTip(event, 'fs4', 15)" class="t">string</span> <span class="o">*</span> <span class="i">contents</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs4', 16)" onmouseover="showTip(event, 'fs4', 16)" class="t">string</span>  <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs5', 17)" onmouseover="showTip(event, 'fs5', 17)" class="t">unit</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs1', 18)" onmouseover="showTip(event, 'fs1', 18)" class="t">IO</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">a</span><span class="o">&gt;</span>)

<span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs9', 19)" onmouseover="showTip(event, 'fs9', 19)" class="f">ioBind</span> (<span onmouseout="hideTip(event, 'fs10', 20)" onmouseover="showTip(event, 'fs10', 20)" class="f">f</span> <span class="o">:</span> <span class="o">&#39;</span><span class="i">a</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs1', 21)" onmouseover="showTip(event, 'fs1', 21)" class="t">IO</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">b</span><span class="o">&gt;</span>) (<span onmouseout="hideTip(event, 'fs11', 22)" onmouseover="showTip(event, 'fs11', 22)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs1', 23)" onmouseover="showTip(event, 'fs1', 23)" class="t">IO</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">a</span><span class="o">&gt;</span>) <span class="o">=</span>
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs11', 24)" onmouseover="showTip(event, 'fs11', 24)" class="i">m</span> <span class="k">with</span>
    | <span onmouseout="hideTip(event, 'fs2', 25)" onmouseover="showTip(event, 'fs2', 25)" class="p">Pure</span> <span onmouseout="hideTip(event, 'fs12', 26)" onmouseover="showTip(event, 'fs12', 26)" class="i">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs10', 27)" onmouseover="showTip(event, 'fs10', 27)" class="f">f</span> <span onmouseout="hideTip(event, 'fs12', 28)" onmouseover="showTip(event, 'fs12', 28)" class="i">x</span>
    | <span onmouseout="hideTip(event, 'fs3', 29)" onmouseover="showTip(event, 'fs3', 29)" class="p">PutStrLn</span> (<span onmouseout="hideTip(event, 'fs13', 30)" onmouseover="showTip(event, 'fs13', 30)" class="i">str</span>, <span onmouseout="hideTip(event, 'fs14', 31)" onmouseover="showTip(event, 'fs14', 31)" class="f">next</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 32)" onmouseover="showTip(event, 'fs3', 32)" class="p">PutStrLn</span> (<span onmouseout="hideTip(event, 'fs13', 33)" onmouseover="showTip(event, 'fs13', 33)" class="i">str</span>, <span onmouseout="hideTip(event, 'fs14', 34)" onmouseover="showTip(event, 'fs14', 34)" class="f">next</span> <span class="o">&gt;</span><span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs9', 35)" onmouseover="showTip(event, 'fs9', 35)" class="f">ioBind</span> <span onmouseout="hideTip(event, 'fs10', 36)" onmouseover="showTip(event, 'fs10', 36)" class="f">f</span>)
    | <span onmouseout="hideTip(event, 'fs6', 37)" onmouseover="showTip(event, 'fs6', 37)" class="p">GetStrLn</span> (<span onmouseout="hideTip(event, 'fs15', 38)" onmouseover="showTip(event, 'fs15', 38)" class="f">next</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs6', 39)" onmouseover="showTip(event, 'fs6', 39)" class="p">GetStrLn</span> (<span onmouseout="hideTip(event, 'fs15', 40)" onmouseover="showTip(event, 'fs15', 40)" class="f">next</span> <span class="o">&gt;</span><span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs9', 41)" onmouseover="showTip(event, 'fs9', 41)" class="f">ioBind</span> <span onmouseout="hideTip(event, 'fs10', 42)" onmouseover="showTip(event, 'fs10', 42)" class="f">f</span>)
    | <span onmouseout="hideTip(event, 'fs7', 43)" onmouseover="showTip(event, 'fs7', 43)" class="p">ReadFile</span> (<span onmouseout="hideTip(event, 'fs16', 44)" onmouseover="showTip(event, 'fs16', 44)" class="i">name</span>, <span onmouseout="hideTip(event, 'fs15', 45)" onmouseover="showTip(event, 'fs15', 45)" class="f">next</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs7', 46)" onmouseover="showTip(event, 'fs7', 46)" class="p">ReadFile</span> (<span onmouseout="hideTip(event, 'fs16', 47)" onmouseover="showTip(event, 'fs16', 47)" class="i">name</span>, <span onmouseout="hideTip(event, 'fs15', 48)" onmouseover="showTip(event, 'fs15', 48)" class="f">next</span> <span class="o">&gt;</span><span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs9', 49)" onmouseover="showTip(event, 'fs9', 49)" class="f">ioBind</span> <span onmouseout="hideTip(event, 'fs10', 50)" onmouseover="showTip(event, 'fs10', 50)" class="f">f</span>)
    | <span onmouseout="hideTip(event, 'fs8', 51)" onmouseover="showTip(event, 'fs8', 51)" class="p">WriteFile</span> (<span onmouseout="hideTip(event, 'fs16', 52)" onmouseover="showTip(event, 'fs16', 52)" class="i">name</span>, <span onmouseout="hideTip(event, 'fs17', 53)" onmouseover="showTip(event, 'fs17', 53)" class="i">contents</span>, <span onmouseout="hideTip(event, 'fs14', 54)" onmouseover="showTip(event, 'fs14', 54)" class="f">next</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs8', 55)" onmouseover="showTip(event, 'fs8', 55)" class="p">WriteFile</span> (<span onmouseout="hideTip(event, 'fs16', 56)" onmouseover="showTip(event, 'fs16', 56)" class="i">name</span>, <span onmouseout="hideTip(event, 'fs17', 57)" onmouseover="showTip(event, 'fs17', 57)" class="i">contents</span>, <span onmouseout="hideTip(event, 'fs14', 58)" onmouseover="showTip(event, 'fs14', 58)" class="f">next</span> <span class="o">&gt;</span><span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs9', 59)" onmouseover="showTip(event, 'fs9', 59)" class="f">ioBind</span> <span onmouseout="hideTip(event, 'fs10', 60)" onmouseover="showTip(event, 'fs10', 60)" class="f">f</span>)

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs18', 61)" onmouseover="showTip(event, 'fs18', 61)" class="t">IOBuilder</span>() <span class="o">=</span>
    <span class="k">member</span> <span onmouseout="hideTip(event, 'fs19', 62)" onmouseover="showTip(event, 'fs19', 62)" class="i">this</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 63)" onmouseover="showTip(event, 'fs20', 63)" class="f">Return</span>(<span onmouseout="hideTip(event, 'fs21', 64)" onmouseover="showTip(event, 'fs21', 64)" class="i">x</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs2', 65)" onmouseover="showTip(event, 'fs2', 65)" class="p">Pure</span> <span onmouseout="hideTip(event, 'fs21', 66)" onmouseover="showTip(event, 'fs21', 66)" class="i">x</span>
    <span class="k">member</span> <span onmouseout="hideTip(event, 'fs19', 67)" onmouseover="showTip(event, 'fs19', 67)" class="i">this</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 68)" onmouseover="showTip(event, 'fs22', 68)" class="f">Bind</span>(<span onmouseout="hideTip(event, 'fs23', 69)" onmouseover="showTip(event, 'fs23', 69)" class="i">m</span>, <span onmouseout="hideTip(event, 'fs24', 70)" onmouseover="showTip(event, 'fs24', 70)" class="f">f</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs9', 71)" onmouseover="showTip(event, 'fs9', 71)" class="f">ioBind</span> <span onmouseout="hideTip(event, 'fs24', 72)" onmouseover="showTip(event, 'fs24', 72)" class="f">f</span> <span onmouseout="hideTip(event, 'fs23', 73)" onmouseover="showTip(event, 'fs23', 73)" class="i">m</span>
    <span class="k">member</span> <span onmouseout="hideTip(event, 'fs19', 74)" onmouseover="showTip(event, 'fs19', 74)" class="i">this</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 75)" onmouseover="showTip(event, 'fs25', 75)" class="f">Zero</span>(<span onmouseout="hideTip(event, 'fs12', 76)" onmouseover="showTip(event, 'fs12', 76)" class="i">x</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs2', 77)" onmouseover="showTip(event, 'fs2', 77)" class="p">Pure</span> ()

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs26', 78)" onmouseover="showTip(event, 'fs26', 78)" class="i">io</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs18', 79)" onmouseover="showTip(event, 'fs18', 79)" class="t">IOBuilder</span>()
</code></pre></td>
</tr>
</table>
<p>Przygotowaliśmy Monadę zawierającą kilka pożądanych przez nas operacji. W zasadzie dopóki nie napiszemy interpretera dla tej monady, to zbudowanie jej nie będzie miało żadnych efektów.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs27', 80)" onmouseover="showTip(event, 'fs27', 80)" class="f">pureNext</span> <span class="o">=</span> <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs12', 81)" onmouseover="showTip(event, 'fs12', 81)" class="i">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs2', 82)" onmouseover="showTip(event, 'fs2', 82)" class="p">Pure</span> <span onmouseout="hideTip(event, 'fs12', 83)" onmouseover="showTip(event, 'fs12', 83)" class="i">x</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs28', 84)" onmouseover="showTip(event, 'fs28', 84)" class="f">putStrLn</span> <span onmouseout="hideTip(event, 'fs29', 85)" onmouseover="showTip(event, 'fs29', 85)" class="i">s</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 86)" onmouseover="showTip(event, 'fs3', 86)" class="p">PutStrLn</span> (<span onmouseout="hideTip(event, 'fs29', 87)" onmouseover="showTip(event, 'fs29', 87)" class="i">s</span>, <span onmouseout="hideTip(event, 'fs27', 88)" onmouseover="showTip(event, 'fs27', 88)" class="f">pureNext</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs30', 89)" onmouseover="showTip(event, 'fs30', 89)" class="i">getStrLn</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 90)" onmouseover="showTip(event, 'fs6', 90)" class="p">GetStrLn</span> <span onmouseout="hideTip(event, 'fs27', 91)" onmouseover="showTip(event, 'fs27', 91)" class="f">pureNext</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs31', 92)" onmouseover="showTip(event, 'fs31', 92)" class="f">readFile</span> <span onmouseout="hideTip(event, 'fs16', 93)" onmouseover="showTip(event, 'fs16', 93)" class="i">name</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 94)" onmouseover="showTip(event, 'fs7', 94)" class="p">ReadFile</span> (<span onmouseout="hideTip(event, 'fs16', 95)" onmouseover="showTip(event, 'fs16', 95)" class="i">name</span>, <span onmouseout="hideTip(event, 'fs27', 96)" onmouseover="showTip(event, 'fs27', 96)" class="f">pureNext</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs32', 97)" onmouseover="showTip(event, 'fs32', 97)" class="f">writeFile</span> <span onmouseout="hideTip(event, 'fs16', 98)" onmouseover="showTip(event, 'fs16', 98)" class="i">name</span> <span onmouseout="hideTip(event, 'fs17', 99)" onmouseover="showTip(event, 'fs17', 99)" class="i">contents</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs8', 100)" onmouseover="showTip(event, 'fs8', 100)" class="p">WriteFile</span> (<span onmouseout="hideTip(event, 'fs16', 101)" onmouseover="showTip(event, 'fs16', 101)" class="i">name</span>, <span onmouseout="hideTip(event, 'fs17', 102)" onmouseover="showTip(event, 'fs17', 102)" class="i">contents</span>, <span onmouseout="hideTip(event, 'fs27', 103)" onmouseover="showTip(event, 'fs27', 103)" class="f">pureNext</span>)

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs33', 104)" onmouseover="showTip(event, 'fs33', 104)" class="i">program</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs26', 105)" onmouseover="showTip(event, 'fs26', 105)" class="i">io</span> {
        <span class="k">do!</span> <span onmouseout="hideTip(event, 'fs28', 106)" onmouseover="showTip(event, 'fs28', 106)" class="f">putStrLn</span> <span class="s">&quot;Podaj nazwę pliku:&quot;</span>
        <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs34', 107)" onmouseover="showTip(event, 'fs34', 107)" class="i">fname</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs30', 108)" onmouseover="showTip(event, 'fs30', 108)" class="i">getStrLn</span>
        <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs17', 109)" onmouseover="showTip(event, 'fs17', 109)" class="i">contents</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs31', 110)" onmouseover="showTip(event, 'fs31', 110)" class="f">readFile</span> <span onmouseout="hideTip(event, 'fs34', 111)" onmouseover="showTip(event, 'fs34', 111)" class="i">fname</span>
        <span class="k">do!</span> <span onmouseout="hideTip(event, 'fs32', 112)" onmouseover="showTip(event, 'fs32', 112)" class="f">writeFile</span> <span onmouseout="hideTip(event, 'fs34', 113)" onmouseover="showTip(event, 'fs34', 113)" class="i">fname</span> (<span onmouseout="hideTip(event, 'fs17', 114)" onmouseover="showTip(event, 'fs17', 114)" class="i">contents</span> <span class="o">+</span> <span class="s">&quot;appended line.</span><span class="e">\n</span><span class="s">&quot;</span>)
    }
</code></pre></td>
</tr>
</table>
<p>Napisaliśmy program, który wczytuje zawartość pliku na podstawie jego nazwy od użytkownika, a następnie dopisuje linijkę. Teraz utworzymy interpreter naszej monady.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs35', 115)" onmouseover="showTip(event, 'fs35', 115)" class="f">interpret</span> <span onmouseout="hideTip(event, 'fs36', 116)" onmouseover="showTip(event, 'fs36', 116)" class="i">program</span> <span class="o">=</span> 
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs36', 117)" onmouseover="showTip(event, 'fs36', 117)" class="i">program</span> <span class="k">with</span>
    | <span onmouseout="hideTip(event, 'fs2', 118)" onmouseover="showTip(event, 'fs2', 118)" class="p">Pure</span> <span onmouseout="hideTip(event, 'fs12', 119)" onmouseover="showTip(event, 'fs12', 119)" class="i">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs12', 120)" onmouseover="showTip(event, 'fs12', 120)" class="i">x</span>
    | <span onmouseout="hideTip(event, 'fs3', 121)" onmouseover="showTip(event, 'fs3', 121)" class="p">PutStrLn</span> (<span onmouseout="hideTip(event, 'fs13', 122)" onmouseover="showTip(event, 'fs13', 122)" class="i">str</span>, <span onmouseout="hideTip(event, 'fs14', 123)" onmouseover="showTip(event, 'fs14', 123)" class="f">next</span>) <span class="k">-&gt;</span>
        <span class="k">do</span> <span onmouseout="hideTip(event, 'fs37', 124)" onmouseover="showTip(event, 'fs37', 124)" class="f">printfn</span> <span class="s">&quot;</span><span class="pf">%s</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs13', 125)" onmouseover="showTip(event, 'fs13', 125)" class="i">str</span>
        <span onmouseout="hideTip(event, 'fs35', 126)" onmouseover="showTip(event, 'fs35', 126)" class="f">interpret</span> (<span onmouseout="hideTip(event, 'fs14', 127)" onmouseover="showTip(event, 'fs14', 127)" class="f">next</span> ())
    | <span onmouseout="hideTip(event, 'fs6', 128)" onmouseover="showTip(event, 'fs6', 128)" class="p">GetStrLn</span> <span onmouseout="hideTip(event, 'fs15', 129)" onmouseover="showTip(event, 'fs15', 129)" class="f">next</span> <span class="k">-&gt;</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs29', 130)" onmouseover="showTip(event, 'fs29', 130)" class="i">s</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs38', 131)" onmouseover="showTip(event, 'fs38', 131)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 132)" onmouseover="showTip(event, 'fs39', 132)" class="t">Console</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 133)" onmouseover="showTip(event, 'fs40', 133)" class="f">ReadLine</span>()
        <span onmouseout="hideTip(event, 'fs35', 134)" onmouseover="showTip(event, 'fs35', 134)" class="f">interpret</span> (<span onmouseout="hideTip(event, 'fs15', 135)" onmouseover="showTip(event, 'fs15', 135)" class="f">next</span> <span onmouseout="hideTip(event, 'fs29', 136)" onmouseover="showTip(event, 'fs29', 136)" class="i">s</span>)
    | <span onmouseout="hideTip(event, 'fs7', 137)" onmouseover="showTip(event, 'fs7', 137)" class="p">ReadFile</span> (<span onmouseout="hideTip(event, 'fs16', 138)" onmouseover="showTip(event, 'fs16', 138)" class="i">name</span>, <span onmouseout="hideTip(event, 'fs15', 139)" onmouseover="showTip(event, 'fs15', 139)" class="f">next</span>) <span class="k">-&gt;</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs29', 140)" onmouseover="showTip(event, 'fs29', 140)" class="i">s</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs38', 141)" onmouseover="showTip(event, 'fs38', 141)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs41', 142)" onmouseover="showTip(event, 'fs41', 142)" class="i">IO</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs42', 143)" onmouseover="showTip(event, 'fs42', 143)" class="t">File</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 144)" onmouseover="showTip(event, 'fs43', 144)" class="f">ReadAllText</span>(<span onmouseout="hideTip(event, 'fs16', 145)" onmouseover="showTip(event, 'fs16', 145)" class="i">name</span>)
        <span onmouseout="hideTip(event, 'fs35', 146)" onmouseover="showTip(event, 'fs35', 146)" class="f">interpret</span> (<span onmouseout="hideTip(event, 'fs15', 147)" onmouseover="showTip(event, 'fs15', 147)" class="f">next</span> <span onmouseout="hideTip(event, 'fs29', 148)" onmouseover="showTip(event, 'fs29', 148)" class="i">s</span>)
    | <span onmouseout="hideTip(event, 'fs8', 149)" onmouseover="showTip(event, 'fs8', 149)" class="p">WriteFile</span> (<span onmouseout="hideTip(event, 'fs16', 150)" onmouseover="showTip(event, 'fs16', 150)" class="i">name</span>, <span onmouseout="hideTip(event, 'fs44', 151)" onmouseover="showTip(event, 'fs44', 151)" class="i">cnt</span>, <span onmouseout="hideTip(event, 'fs14', 152)" onmouseover="showTip(event, 'fs14', 152)" class="f">next</span>) <span class="k">-&gt;</span>
        <span class="k">do</span> <span onmouseout="hideTip(event, 'fs38', 153)" onmouseover="showTip(event, 'fs38', 153)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs41', 154)" onmouseover="showTip(event, 'fs41', 154)" class="i">IO</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs42', 155)" onmouseover="showTip(event, 'fs42', 155)" class="t">File</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs45', 156)" onmouseover="showTip(event, 'fs45', 156)" class="f">WriteAllText</span>(<span onmouseout="hideTip(event, 'fs16', 157)" onmouseover="showTip(event, 'fs16', 157)" class="i">name</span>, <span onmouseout="hideTip(event, 'fs44', 158)" onmouseover="showTip(event, 'fs44', 158)" class="i">cnt</span>)
        <span onmouseout="hideTip(event, 'fs35', 159)" onmouseover="showTip(event, 'fs35', 159)" class="f">interpret</span> (<span onmouseout="hideTip(event, 'fs14', 160)" onmouseover="showTip(event, 'fs14', 160)" class="f">next</span> ())
</code></pre></td>
</tr>
</table>
<p>Kiedy uruchomimy ten interpreter na naszym programie to wtedy po kolei będziemy wykonywać określone czynności.</p>
<p><code>Pure</code> oznacza po prostu jakąś wartość. <code>PutStrLn</code> niesie ze sobą string do wypisania na ekran oraz będzie zwracać <code>()</code> do funkcji którą przekazuje do <code>bind</code>, a na koniec dostajemy kolejne <code>IO</code>, czyli pewną kontynuację do wykonania. Tworzymy taki łańcuch <code>IO</code>, który krok po kroku wykonujemy. Pozostałem <code>GetStrLn</code>, <code>ReadFile</code> i <code>WriteFile</code> zachowują się bardzo podobnie.</p>
<p>Nie będziemy już mieli zadań, a zamiast tego porozmawiamy sobie o monadzie <code>Async</code>, którą można nieco potraktować jako wolną monadę do asynchronicznych operacji.</p>

<div class="tip" id="fs1">type IO&lt;&#39;a&gt; =<br />&#160;&#160;| Pure of &#39;a<br />&#160;&#160;| PutStrLn of string * (unit -&gt; IO&lt;&#39;a&gt;)<br />&#160;&#160;| GetStrLn of (string -&gt; IO&lt;&#39;a&gt;)<br />&#160;&#160;| ReadFile of name: string * (string -&gt; IO&lt;&#39;a&gt;)<br />&#160;&#160;| WriteFile of name: string * contents: string * (unit -&gt; IO&lt;&#39;a&gt;)<br /><br />Full name: Io_monad.IO&lt;_&gt;</div>
<div class="tip" id="fs2">union case IO.Pure: &#39;a -&gt; IO&lt;&#39;a&gt;</div>
<div class="tip" id="fs3">union case IO.PutStrLn: string * (unit -&gt; IO&lt;&#39;a&gt;) -&gt; IO&lt;&#39;a&gt;</div>
<div class="tip" id="fs4">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = System.String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs5">type unit = Unit<br /><br />Full name: Microsoft.FSharp.Core.unit</div>
<div class="tip" id="fs6">union case IO.GetStrLn: (string -&gt; IO&lt;&#39;a&gt;) -&gt; IO&lt;&#39;a&gt;</div>
<div class="tip" id="fs7">union case IO.ReadFile: name: string * (string -&gt; IO&lt;&#39;a&gt;) -&gt; IO&lt;&#39;a&gt;</div>
<div class="tip" id="fs8">union case IO.WriteFile: name: string * contents: string * (unit -&gt; IO&lt;&#39;a&gt;) -&gt; IO&lt;&#39;a&gt;</div>
<div class="tip" id="fs9">val ioBind : f:(&#39;a -&gt; IO&lt;&#39;b&gt;) -&gt; m:IO&lt;&#39;a&gt; -&gt; IO&lt;&#39;b&gt;<br /><br />Full name: Io_monad.ioBind</div>
<div class="tip" id="fs10">val f : (&#39;a -&gt; IO&lt;&#39;b&gt;)</div>
<div class="tip" id="fs11">val m : IO&lt;&#39;a&gt;</div>
<div class="tip" id="fs12">val x : &#39;a</div>
<div class="tip" id="fs13">val str : string</div>
<div class="tip" id="fs14">val next : (unit -&gt; IO&lt;&#39;a&gt;)</div>
<div class="tip" id="fs15">val next : (string -&gt; IO&lt;&#39;a&gt;)</div>
<div class="tip" id="fs16">val name : string</div>
<div class="tip" id="fs17">val contents : string</div>
<div class="tip" id="fs18">Multiple items<br />type IOBuilder =<br />&#160;&#160;new : unit -&gt; IOBuilder<br />&#160;&#160;member Bind : m:IO&lt;&#39;b&gt; * f:(&#39;b -&gt; IO&lt;&#39;c&gt;) -&gt; IO&lt;&#39;c&gt;<br />&#160;&#160;member Return : x:&#39;d -&gt; IO&lt;&#39;d&gt;<br />&#160;&#160;member Zero : x:&#39;a -&gt; IO&lt;unit&gt;<br /><br />Full name: Io_monad.IOBuilder<br /><br />--------------------<br />new : unit -&gt; IOBuilder</div>
<div class="tip" id="fs19">val this : IOBuilder</div>
<div class="tip" id="fs20">member IOBuilder.Return : x:&#39;d -&gt; IO&lt;&#39;d&gt;<br /><br />Full name: Io_monad.IOBuilder.Return</div>
<div class="tip" id="fs21">val x : &#39;d</div>
<div class="tip" id="fs22">member IOBuilder.Bind : m:IO&lt;&#39;b&gt; * f:(&#39;b -&gt; IO&lt;&#39;c&gt;) -&gt; IO&lt;&#39;c&gt;<br /><br />Full name: Io_monad.IOBuilder.Bind</div>
<div class="tip" id="fs23">val m : IO&lt;&#39;b&gt;</div>
<div class="tip" id="fs24">val f : (&#39;b -&gt; IO&lt;&#39;c&gt;)</div>
<div class="tip" id="fs25">member IOBuilder.Zero : x:&#39;a -&gt; IO&lt;unit&gt;<br /><br />Full name: Io_monad.IOBuilder.Zero</div>
<div class="tip" id="fs26">val io : IOBuilder<br /><br />Full name: Io_monad.io</div>
<div class="tip" id="fs27">val pureNext : x:&#39;a -&gt; IO&lt;&#39;a&gt;<br /><br />Full name: Io_monad.pureNext</div>
<div class="tip" id="fs28">val putStrLn : s:string -&gt; IO&lt;unit&gt;<br /><br />Full name: Io_monad.putStrLn</div>
<div class="tip" id="fs29">val s : string</div>
<div class="tip" id="fs30">val getStrLn : IO&lt;string&gt;<br /><br />Full name: Io_monad.getStrLn</div>
<div class="tip" id="fs31">val readFile : name:string -&gt; IO&lt;string&gt;<br /><br />Full name: Io_monad.readFile</div>
<div class="tip" id="fs32">val writeFile : name:string -&gt; contents:string -&gt; IO&lt;unit&gt;<br /><br />Full name: Io_monad.writeFile</div>
<div class="tip" id="fs33">val program : IO&lt;unit&gt;<br /><br />Full name: Io_monad.program</div>
<div class="tip" id="fs34">val fname : string</div>
<div class="tip" id="fs35">val interpret : program:IO&lt;&#39;a&gt; -&gt; &#39;a<br /><br />Full name: Io_monad.interpret</div>
<div class="tip" id="fs36">val program : IO&lt;&#39;a&gt;</div>
<div class="tip" id="fs37">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs38">namespace System</div>
<div class="tip" id="fs39">type Console =<br />&#160;&#160;static member BackgroundColor : ConsoleColor with get, set<br />&#160;&#160;static member Beep : unit -&gt; unit + 1 overload<br />&#160;&#160;static member BufferHeight : int with get, set<br />&#160;&#160;static member BufferWidth : int with get, set<br />&#160;&#160;static member CapsLock : bool<br />&#160;&#160;static member Clear : unit -&gt; unit<br />&#160;&#160;static member CursorLeft : int with get, set<br />&#160;&#160;static member CursorSize : int with get, set<br />&#160;&#160;static member CursorTop : int with get, set<br />&#160;&#160;static member CursorVisible : bool with get, set<br />&#160;&#160;...<br /><br />Full name: System.Console</div>
<div class="tip" id="fs40">System.Console.ReadLine() : string</div>
<div class="tip" id="fs41">namespace System.IO</div>
<div class="tip" id="fs42">type File =<br />&#160;&#160;static member AppendAllLines : path:string * contents:IEnumerable&lt;string&gt; -&gt; unit + 1 overload<br />&#160;&#160;static member AppendAllText : path:string * contents:string -&gt; unit + 1 overload<br />&#160;&#160;static member AppendText : path:string -&gt; StreamWriter<br />&#160;&#160;static member Copy : sourceFileName:string * destFileName:string -&gt; unit + 1 overload<br />&#160;&#160;static member Create : path:string -&gt; FileStream + 3 overloads<br />&#160;&#160;static member CreateText : path:string -&gt; StreamWriter<br />&#160;&#160;static member Decrypt : path:string -&gt; unit<br />&#160;&#160;static member Delete : path:string -&gt; unit<br />&#160;&#160;static member Encrypt : path:string -&gt; unit<br />&#160;&#160;static member Exists : path:string -&gt; bool<br />&#160;&#160;...<br /><br />Full name: System.IO.File</div>
<div class="tip" id="fs43">System.IO.File.ReadAllText(path: string) : string<br />System.IO.File.ReadAllText(path: string, encoding: System.Text.Encoding) : string</div>
<div class="tip" id="fs44">val cnt : string</div>
<div class="tip" id="fs45">System.IO.File.WriteAllText(path: string, contents: string) : unit<br />System.IO.File.WriteAllText(path: string, contents: string, encoding: System.Text.Encoding) : unit</div>

        </div>
        <div class="span3">
          <img src="/fun-girlz/img/logo.png" alt="F# Project" style="width:150px;margin:10px" />  
        </div>
      </div>
    </div>
  </body>
  </html>
